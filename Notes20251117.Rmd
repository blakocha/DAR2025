---
title: "Notes20251117"
author: "Blazej Kochanski"
date: "2025-11-17"
output: html_document
---

We will use ggplot2 package. 

```{r}
library(ggplot2)
```

UsingR packages has the Pearson's data from ca. 1900. 

```{r}
#install.packages("UsingR")
```

```{r}
library(UsingR)
data(father.son)
head(father.son)
```

Now let us build the scatter plot of fathers and sons' height. Father's height on x-axis and son's height on y axis. 

```{r}
ggplot(data = father.son, 
       mapping = aes(x = fheight, y = sheight)) +
  geom_point()
```


Add `alpha = 0.4` to see through the points (they will be 60% transparent). 

```{r}
ggplot(data = father.son, 
       mapping = aes(x = fheight, y = sheight)) +
  geom_point(alpha = 0.4)
```

The descriptions of the axes. 

```{r}
ggplot(data = father.son, 
       mapping = aes(x = fheight, y = sheight)) +
  geom_point(alpha = 0.4, col="blue") +
  xlab("Father's height [inches]") +
  ylab("Son's height [inches]") +
  ggtitle("Scatter plot of Pearson's father/son data")
```


Let us colour the dots where fathers where ~70 inches tall. 

```{r}
# Auxiliary table with the families where rounded height of the father is 70 inches
df70 <- father.son[round(father.son$fheight)==70, ]
```

```{r}
ggplot(data = father.son, 
       mapping = aes(x = fheight, y = sheight)) +
  geom_point(alpha = 0.4, col="black") +
  geom_point(data = df70, alpha = 0.4, col = "blue") +
  xlab("Father's height [inches]") +
  ylab("Son's height [inches]") +
  ggtitle("Scatter plot of Pearson's father/son data")
```

Now, colour the dots where fathers where ~67 inches tall (in green) and ~64 inches tall (in yellow). 

```{r}
# Auxiliary tables
df67 <- father.son[round(father.son$fheight)==67, ]
df64 <- father.son[round(father.son$fheight)==64, ]

G <- ggplot(data = father.son, 
       mapping = aes(x = fheight, y = sheight)) +
  geom_point(alpha = 0.4, col="black") +
  geom_point(data = df70, alpha = 0.4, col = "blue") +
  geom_point(data = df67, alpha = 0.4, col = "chartreuse4") +
  geom_point(data = df64, alpha = 0.4, col = "yellow2") +
  xlab("Father's height [inches]") +
  ylab("Son's height [inches]") +
  ggtitle("Scatter plot of Pearson's father/son data")

G 
```

What is the average height of the son if father's height is around (a) 64, (b) 67, (c) 70 inches. 
Store the results in variables called avgs_64, avgs_67, avgs_70.
Add the points and the __regression line__ (linear regression) to plot.  

```{r}
# mean(father.son$sheight[round(father.son$fheight)==64])
(avgs_64 <- mean(df64$sheight))
(avgs_67 <- mean(df67$sheight))
(avgs_70 <- mean(df70$sheight))
```


```{r}
G + 
  geom_point(data = data.frame(x=64, y=avgs_64), aes(x = x, y = y), 
             col = "orange", size = 4) +
  geom_point(data = data.frame(x=67, y=avgs_67), aes(x = x, y = y), 
             col = "darkgreen", size = 4) +
  geom_point(data = data.frame(x=70, y=avgs_70), aes(x = x, y = y), 
             col = "blue", size = 4) +
  geom_smooth(method = "lm", col="red")
```


Boxplots: let's have two boxplots in one chart for the fathers' height and sons' height. Horizontal. Use `ggplot`. 

Reshape the data: 

```{r warning=FALSE, message=FALSE}
# Reshape to long format
library(dplyr)
library(tidyr)
df_long <- father.son %>%
  pivot_longer(cols = c(fheight, sheight),
               names_to = "group",
               values_to = "height") %>%
  mutate(group = recode(group,
                        fheight = "Father",
                        sheight = "Son"))
head(df_long)
```

```{r}
ggplot(df_long, aes(x = height, y = group, fill = group)) +
  geom_boxplot() +
  labs(y = "", x = "Height (inches)", title = "Father vs Son Heights")
```

You can use similar ggplot structure to generate violin plots. Just put `geom_violin` instead of `geom_boxplot`:

```{r}
ggplot(df_long, aes(x = height, y = group, fill = group)) +
  geom_violin() +
  labs(y = "", x = "Height (inches)", title = "Father vs Son Heights")
```

Recommended book on visualization: 

[Fundamentals of Data Visualization](https://clauswilke.com/dataviz/)

[Github page of the book with codes in R](https://github.com/clauswilke/dataviz)

Task: try to create a "Strip chart" using the last example (boxplots and violins) as a starting point. 

![](https://clauswilke.com/dataviz/directory_of_visualizations_files/figure-html/multiple-distributions-1.png)

```{r}
ggplot(df_long, aes(x = height, y = group, colour = group)) +
  geom_jitter(width = 0, height = 0.2, alpha = 0.4) +
  labs(y = "", x = "Height (inches)", title = "Father vs Son Heights")
```

Another idea: "plotly" wrapper enabling some interactivity. 

```{r warning=FALSE, message=FALSE}
#install.packages("plotly")
library(plotly)
ggplotly(G)
```


