---
title: "Notes 2025-10-27"
author: "Blazej Kochanski"
date: "2025-10-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Descriptive statistics in R - correlation / association

## The data

```{r}
library(googlesheets4)
gs4_deauth()
d <- read_sheet("https://docs.google.com/spreadsheets/d/1I1ZJ4I345TfaHvyCCgzMz8pMsfS_J3yi9WcpcrhO6No/edit?usp=sharing", "clean_data")
```

## Pearson correlation coefficient

Measures the **linear** correlation between two quantitative (numeric) variables. See [wikipedia](https://en.wikipedia.org/wiki/Pearson_correlation_coefficient)

Example: correlation between right and left hand span. 

```{r}
plot(d$right_hand_span, d$left_hand_span, pch=16, col=rgb(0,0,0,.4))
cor(d$right_hand_span, d$left_hand_span)
```


Correlation between the height and average hand span?

```{r}
d$avg_hand_span = (d$right_hand_span + d$left_hand_span)/2
cor(d$avg_hand_span, d$height)
```

Correlation between the height and average hand span for males? 

I create a filter (called `mask`). It is a logical vector with `TRUE` when the observation is a `"Male"` and `FALSE` otherwise. [Why do I use double ==? Check what the comparison operator in R are (link)](https://www.geeksforgeeks.org/r-language/what-are-comparison-operators-in-r/)

```{r}
mask <- (d$gender == "Male") 
plot(d$avg_hand_span[mask], d$height[mask], pch=16, col=rgb(0,0,0,.4))
cor(d$avg_hand_span[mask], d$height[mask])
```

Example [from the history by Galton](https://www.rdocumentation.org/packages/HistData/versions/0.9-3/topics/Galton): correlation between the so-called "midparent" height and an adult child height (both in inches):

```{r}
#install.packages("HistData")
library(HistData)
data(Galton)
plot(jitter(Galton$parent), jitter(Galton$child), 
     pch=16, col=rgb(0,0,0,.4))
cor(Galton$parent, Galton$child)
```

## Spearman's rank correlation coefficient

[Spearman's rank correlation coefficient](https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient) is the correlation coefficient based on ranks instead of the raw values.

It can be calculated for quantitative (numeric) and ........  variables. 

What are ranks? Example. 

| raw values | ranks |
|:---------:|:-----:|
| 5 | 1 |
| 6 | 2 |
| 9 | 3.5 |
| 9 | 3.5 |
| 14 | 6.0 |
| 14 | 6.0 |
| 14 | 6.0 |
| 20 | 8.0 |

Calculate the Spearman's coefficient for height and head_circ. And compare it to the Pearson coefficient. Separately for Males and Females. 

Males: 
Pearson: `r cor(d$height[mask], d$head_circ[mask], use="pairwise.complete.obs")`
Spearman: `r cor(d$height[mask], d$head_circ[mask], method="spearman", use="pairwise.complete.obs")`

Females: 
Pearson: `r cor(d$height[!mask], d$head_circ[!mask])`
Spearman: `r cor(d$height[!mask], d$head_circ[!mask], method="spearman")`
